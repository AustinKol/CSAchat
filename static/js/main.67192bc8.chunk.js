(this["webpackJsonpcsa-chat"]=this["webpackJsonpcsa-chat"]||[]).push([[0],{82:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(2),r=n.n(c),s=n(28),i=n.n(s),o=n(86),l=n(87),j=n(53),d=n(88),b=n(89),u=n(19),h=n.p+"static/media/conversation-animate.3ad3761f.svg",x=n.p+"static/media/example-animate.edd3b698.svg";var p=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(o.a,{children:Object(a.jsxs)(l.a,{children:[Object(a.jsx)(j.a,{md:6,bsPrefix:"col align-self-center",children:Object(a.jsxs)(d.a,{className:"mb-0",style:{backgroundColor:"transparent"},children:[Object(a.jsx)("h1",{children:"Bienvenue"}),Object(a.jsx)("p",{children:"Nous sommes les pairs-aidants. Nous sommes i\xe7i pour vous aider. Chattez avec nous!"}),Object(a.jsx)("p",{children:Object(a.jsx)(b.a,{as:u.b,to:"/about",variant:"primary",children:"Nous conna\xeetre plus"})})]})}),Object(a.jsx)(j.a,{md:6,children:Object(a.jsx)("img",{src:h,alt:"Art"})})]})}),Object(a.jsxs)(o.a,{className:"hatched",children:[Object(a.jsx)(l.a,{children:Object(a.jsx)(j.a,{className:"text-center",children:Object(a.jsx)("h1",{className:"pt-5 font-weight-bold font-weight-italic",children:"Chattez Maintenant!"})})}),Object(a.jsx)(l.a,{className:"mt-5 mb-5",children:Object(a.jsxs)(j.a,{className:"arrow",children:[Object(a.jsx)("span",{}),Object(a.jsx)("span",{}),Object(a.jsx)("span",{})]})}),Object(a.jsx)(l.a,{children:Object(a.jsx)(j.a,{md:12,className:"justfiy-content-md-center",children:Object(a.jsx)(u.b,{to:"/anon",children:Object(a.jsx)("img",{src:x,alt:"chatButton"})})})})]})]})};var O=function(){return Object(a.jsx)(a.Fragment,{children:'"En progr\xe8s"'})},m=n(22),f=n(21),g=n(34),v=n(55),I=n(93),y=n(35),C=n(23),F=n.n(C),w=n(29),k=n(9),N=(n(80),n(52),n(91));var S=function(e){var t=k.a.firestore(),n=Object(c.useState)(""),r=Object(m.a)(n,2),s=r[0],i=r[1],d=Object(c.useRef)(null),u=t.collection("users").doc(e.uid).collection("messages"),h=u.orderBy("time"),x="Ce chat a \xe9t\xe9 ferm\xe9 par le mod\xe9rateur.",p=function(){var n=Object(w.a)(F.a.mark((function n(a,c){return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("[II] Checking isFinished and timeCreated"),t.collection("users").doc(e.uid).get().then((function(n){var a,c;(null===(a=n.data())||void 0===a?void 0:a.timeCreated)&&(null===(c=n.data())||void 0===c?void 0:c.isFinished)||(console.log("[II] Setting timestamp"),t.collection("users").doc(e.uid).set({timeCreated:k.a.firestore.FieldValue.serverTimestamp(),isFinished:!1}))})),console.log("[II] Sending message"),n.next=5,u.add({text:a,time:k.a.firestore.FieldValue.serverTimestamp(),person:c});case 5:i("");case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();function O(){return(O=Object(w.a)(F.a.mark((function n(){return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p(x,1);case 2:return n.next=4,t.collection("users").doc(e.uid).update({isFinished:!0});case 4:e.thread("");case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var f=Object(y.b)(h),g=Object(m.a)(f,1)[0];console.log("[II] Registering messages query");var v={maxWidth:"50%",wordWrap:"break-word",placeSelf:"flex-start",borderColor:"#007bff",borderRadius:"3px",marginTop:"3px",borderWidth:"1px"},C={maxWidth:"50%",wordWrap:"break-word",placeSelf:"flex-end",borderRadius:"3px",marginTop:"3px",borderWidth:"1px"},S={wordWrap:"break-word",placeSelf:"flex-center",borderColor:"#F01a0a",borderRadius:"3px",marginTop:"3px",borderWidth:"1px"},P=g&&g.map((function(t,n){var c=v;return c=t.person^e.person?v:C,""===t.text?Object(a.jsx)(a.Fragment,{}):(t.text===x&&0===e.person&&(e.signout(),c=S),Object(a.jsx)(I.a.Item,{style:c,children:t.text},n))}));return Object(c.useEffect)((function(){d.current&&d.current.scrollIntoView({behavior:"smooth"})})),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(o.a,{className:"fixed-top",children:1===e.person?Object(a.jsxs)(l.a,{children:[Object(a.jsx)(j.a,{children:Object(a.jsx)(b.a,{onClick:function(){return e.thread("")},children:"Retourner au menu"})}),Object(a.jsx)(j.a,{children:Object(a.jsx)(b.a,{onClick:function(){return O.apply(this,arguments)},children:"Finir ce chat"})})]}):Object(a.jsx)(a.Fragment,{})}),Object(a.jsx)(o.a,{children:Object(a.jsx)(l.a,{children:Object(a.jsx)(j.a,{children:Object(a.jsxs)(I.a,{style:{paddingBottom:"100px"},children:[P,Object(a.jsx)("div",{ref:d})]})})})}),Object(a.jsx)(o.a,{className:"fixed-bottom",style:{backgroundColor:"white"},children:Object(a.jsxs)(N.a,{className:"input-group mb-3",onSubmit:function(){var t=Object(w.a)(F.a.mark((function t(n){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),p(s,e.person);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(a.jsx)(N.a.Control,{value:s,onChange:function(e){return i(e.target.value)},type:"text",placeholder:"Message"}),Object(a.jsx)("div",{className:"input-group-append",children:Object(a.jsx)(b.a,{variant:"outline-primary",type:"submit",children:"Envoyer"})})]})})]})};var P=function(){var e=f.a.firestore().collection("users").orderBy("timeCreated","desc"),t=Object(y.a)(e),n=Object(m.a)(t,3),r=n[0],s=n[1],i=n[2];console.log("[II] Registering teacher dash collection");var o=Object(c.useState)(""),l=Object(m.a)(o,2),j=l[0],d=l[1];return""===j?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("strong",{children:Object(a.jsxs)(I.a,{horizontal:!0,children:[Object(a.jsx)(I.a.Item,{bsPrefix:"list-group-item col-md-2",children:"Personne"}),Object(a.jsx)(I.a.Item,{bsPrefix:"list-group-item col-md-4",children:"Temps Cree"}),Object(a.jsx)(I.a.Item,{bsPrefix:"list-group-item col-md-2",children:"Lien"})]})}),i&&Object(a.jsxs)("strong",{children:["Error: ",JSON.stringify(i)]}),s&&Object(a.jsx)("span",{children:"Loading"}),r&&r.docs.map((function(e,t){return console.log(e.data()),Object(a.jsxs)(I.a,{horizontal:!0,children:[Object(a.jsxs)(I.a.Item,{bsPrefix:"list-group-item col-md-2",children:["Personne ",t+1]}),Object(a.jsx)(I.a.Item,{bsPrefix:"list-group-item col-md-4",children:new Date(1e3*e.data().timeCreated.seconds).toLocaleString()}),Object(a.jsx)(I.a.Item,{bsPrefix:"list-group-item col-md-2",children:Object(a.jsx)(b.a,{onClick:function(){d(e.id)},children:"Contactez"})})]})}))]}):Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(S,{thread:d,uid:j,person:1})})};var A=function(){var e=f.a.auth(),t=Object(g.a)(e),n=Object(m.a)(t,1)[0],c={callbacks:{signInSuccessWithAuthResult:function(e,t){return!1}},signInFlow:"popup",signInOptions:[{provider:f.a.auth.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!1}]};return Object(a.jsx)(a.Fragment,{children:n&&!n.isAnonymous?Object(a.jsx)(P,{}):Object(a.jsx)(v.StyledFirebaseAuth,{uiConfig:c,firebaseAuth:e})})},R=(n(82),n(90)),L=n(92),T=(n(83),n(13));var W=function(){var e=f.a.auth(),t=Object(g.a)(e),n=Object(m.a)(t,2),r=n[0],s=n[1],i=Object(c.useRef)(!1),o=Object(T.f)();function l(){return(l=Object(w.a)(F.a.mark((function t(){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[II] Signing out"),setTimeout((function(){e.signOut(),o.push("/")}),3e3);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(c.useEffect)((function(){i.current||(e.signInAnonymously(),console.log("[II] Singing in"),i.current=!0)}),[e]),Object(a.jsx)(a.Fragment,{children:!s&&(null===r||void 0===r?void 0:r.isAnonymous)?Object(a.jsx)(S,{signout:function(){return l.apply(this,arguments)},uid:r.uid,person:0}):"Telechargement en cours..."})};var E=function(){return Object(a.jsx)(a.Fragment,{children:'"En progr\xe8s"'})};var B=function(){return f.a.apps.length?console.log("[WW] Firebase has already started."):f.a.initializeApp({apiKey:"AIzaSyDpFJ1vMnojgESGXD-yjlQyIXU8GuJNQLA",authDomain:"csachat-9dff3.firebaseapp.com",databaseURL:"https://csachat-9dff3-default-rtdb.firebaseio.com",projectId:"csachat-9dff3",storageBucket:"csachat-9dff3.appspot.com",messagingSenderId:"384915371882",appId:"1:384915371882:web:2a14a7141b635d69381713"}),Object(a.jsxs)(u.a,{basename:"/",children:[Object(a.jsxs)(R.a,{bg:"light",expand:"lg",children:[Object(a.jsx)(R.a.Brand,{as:u.b,to:"/",children:"Pairs-Aidants"}),Object(a.jsx)(R.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(a.jsxs)(R.a.Collapse,{id:"basic-navbar-nav",children:[Object(a.jsxs)(L.a,{className:"mr-auto",children:[Object(a.jsx)(L.a.Link,{as:u.b,to:"/",children:"Accueil"}),Object(a.jsx)(L.a.Link,{as:u.b,to:"/selfhelp",children:"Ressources"}),Object(a.jsx)(L.a.Link,{as:u.b,to:"/about",children:"Nous conna\xeetre"})]}),Object(a.jsx)(L.a,{className:"ml-auto",children:Object(a.jsx)(L.a.Link,{as:u.b,to:"/signin",children:"Connexion"})})]})]}),Object(a.jsxs)(T.c,{children:[Object(a.jsx)(T.a,{exact:!0,path:"/",children:Object(a.jsx)(p,{})}),Object(a.jsx)(T.a,{path:"/signin",children:Object(a.jsx)(A,{})}),Object(a.jsx)(T.a,{path:"/selfhelp",children:Object(a.jsx)(O,{})}),Object(a.jsx)(T.a,{path:"/teacherdash",children:Object(a.jsx)(P,{})}),Object(a.jsx)(T.a,{path:"/anon",children:Object(a.jsx)(W,{})}),Object(a.jsx)(T.a,{path:"/about",children:Object(a.jsx)(E,{})}),Object(a.jsx)(T.a,{path:"/chatpage",children:Object(a.jsx)(S,{})})]})]})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,94)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(B,{})}),document.getElementById("root")),D()}},[[84,1,2]]]);
//# sourceMappingURL=main.67192bc8.chunk.js.map